{
  "openapi": "3.1.0",
  "info": {
    "title": "Product Sustainability & Impact Assessment API",
    "description": "Assess product sustainability and environmental impact (CO2, water) for e-commerce and AI agents. Returns explainable, structured scores.",
    "version": "1.0.0"
  },
  "paths": {
    "/v1/methodology": {
      "get": {
        "summary": "Get calculation methodology",
        "description": "Returns a JSON explanation of how sustainability scores and impact estimates (CO2, water, breakdown) are calculated. Use this to build trust and explain results to users or AI agents.",
        "operationId": "get_methodology_v1_methodology_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MethodologyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v1/assess-impact": {
      "post": {
        "summary": "Assess product sustainability and impact",
        "description": "Submit product details (name, material composition, weight, origin and destination countries) to receive a structured sustainability score, CO2 estimate, water usage, breakdown, CBAM relevance, and limitations. Rate limited per API key.",
        "operationId": "post_assess_impact_v1_assess_impact_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssessImpactRequest"
              },
              "examples": {
                "eco-friendly-tshirt": {
                  "summary": "Eco-friendly T-shirt (Recycled Cotton, 0.2 kg)",
                  "description": "Sample request for a lightweight eco T-shirt made of recycled cotton.",
                  "value": {
                    "product_name": "Eco-friendly T-shirt",
                    "material_composition": {
                      "organic_cotton": 1.0
                    },
                    "weight_kg": 0.2,
                    "origin_country": "Portugal",
                    "destination_country": "Germany"
                  }
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssessImpactResponse"
                },
                "examples": {
                  "eco-friendly-tshirt": {
                    "summary": "Eco-friendly T-shirt response",
                    "description": "Example response with sustainability score, CO2, water, breakdown, and CBAM flag.",
                    "value": {
                      "total_sustainability_score": 72.4,
                      "co2_estimate_kg": 1.89,
                      "water_usage_liters": 3285.0,
                      "breakdown": {
                        "material_score": 73.0,
                        "logistics_score": 70.0,
                        "weight_impact": 90.0
                      },
                      "methodology_version": "1.0.0-indicative",
                      "cbam_relevant": false,
                      "limitations": "This estimate is model-based and intended for internal assessment, not for final regulatory CBAM filings."
                    }
                  }
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "APIKeyHeader": []
          }
        ]
      }
    },
    "/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health",
        "description": "Health check for load balancers and monitoring.",
        "operationId": "health_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AssessImpactRequest": {
        "properties": {
          "product_name": {
            "type": "string",
            "title": "Product Name",
            "description": "Human-readable name of the product (e.g. 'Organic Cotton T-Shirt'). Used for labeling in responses."
          },
          "material_composition": {
            "additionalProperties": {
              "type": "number"
            },
            "type": "object",
            "title": "Material Composition",
            "description": "Share of each material by weight, as decimals summing to 1.0. Example: {\"polyester\": 0.6, \"cotton\": 0.4}."
          },
          "weight_kg": {
            "type": "number",
            "exclusiveMinimum": 0.0,
            "title": "Weight Kg",
            "description": "Product weight in kilograms. Must be greater than 0."
          },
          "origin_country": {
            "type": "string",
            "title": "Origin Country",
            "description": "ISO-style country code or name where the product is produced (e.g. 'CN', 'Bangladesh'). Affects logistics emissions."
          },
          "destination_country": {
            "type": "string",
            "title": "Destination Country",
            "description": "ISO-style country code or name where the product is delivered (e.g. 'US', 'Germany'). Affects logistics emissions."
          }
        },
        "type": "object",
        "required": [
          "product_name",
          "material_composition",
          "weight_kg",
          "origin_country",
          "destination_country"
        ],
        "title": "AssessImpactRequest",
        "description": "Request body for the impact assessment endpoint."
      },
      "AssessImpactResponse": {
        "properties": {
          "total_sustainability_score": {
            "type": "number",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Total Sustainability Score",
            "description": "Overall sustainability score from 0 to 100. Higher is better. Weighted combination of materials, logistics, and weight."
          },
          "co2_estimate_kg": {
            "type": "number",
            "minimum": 0.0,
            "title": "Co2 Estimate Kg",
            "description": "Estimated CO2 equivalent in kg for materials and logistics. Indicative, not certified."
          },
          "water_usage_liters": {
            "type": "number",
            "minimum": 0.0,
            "title": "Water Usage Liters",
            "description": "Estimated water usage in liters (mainly from material production). Indicative."
          },
          "breakdown": {
            "$ref": "#/components/schemas/Breakdown",
            "description": "Per-dimension scores: material_score, logistics_score, weight_impact. Use for explainability."
          },
          "methodology_version": {
            "type": "string",
            "title": "Methodology Version",
            "description": "Version of the calculation methodology. Use to track changes and build trust; 'indicative' means estimates, not certified LCA.",
            "default": "1.0.0-indicative"
          },
          "cbam_relevant": {
            "type": "boolean",
            "title": "Cbam Relevant",
            "description": "True if the product contains CBAM-relevant materials (e.g. steel, aluminum, fertilizer). Indicates potential relevance for EU Carbon Border Adjustment Mechanism reporting; not for final regulatory use.",
            "default": false
          },
          "limitations": {
            "type": "string",
            "title": "Limitations",
            "description": "Short disclaimer for agents: model-based, internal assessment only, not for final regulatory CBAM filings."
          }
        },
        "type": "object",
        "required": [
          "total_sustainability_score",
          "co2_estimate_kg",
          "water_usage_liters",
          "breakdown",
          "limitations"
        ],
        "title": "AssessImpactResponse",
        "description": "Explainable, structured response for AI agents and e-commerce integrations."
      },
      "Breakdown": {
        "properties": {
          "material_score": {
            "type": "number",
            "title": "Material Score",
            "description": "Sustainability score for materials only (0–100). Higher = lower impact materials."
          },
          "logistics_score": {
            "type": "number",
            "title": "Logistics Score",
            "description": "Sustainability score for shipping from origin to destination (0–100). Higher = lower logistics impact."
          },
          "weight_impact": {
            "type": "number",
            "title": "Weight Impact",
            "description": "Contribution of product weight to overall impact (0–100). Heavier products reduce this score."
          }
        },
        "type": "object",
        "required": [
          "material_score",
          "logistics_score",
          "weight_impact"
        ],
        "title": "Breakdown",
        "description": "Per-dimension scores and impacts for explainability."
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "MethodologyResponse": {
        "properties": {
          "methodology_version": {
            "type": "string",
            "title": "Methodology Version",
            "description": "Current methodology version used by the API.",
            "default": "1.0.0-indicative"
          },
          "description": {
            "type": "string",
            "title": "Description",
            "description": "Short summary of the methodology purpose and scope."
          },
          "total_sustainability_score": {
            "additionalProperties": true,
            "type": "object",
            "title": "Total Sustainability Score",
            "description": "How total_sustainability_score is computed (formula and weights)."
          },
          "co2_estimate_kg": {
            "additionalProperties": true,
            "type": "object",
            "title": "Co2 Estimate Kg",
            "description": "How CO2 equivalent is estimated (materials + logistics)."
          },
          "water_usage_liters": {
            "additionalProperties": true,
            "type": "object",
            "title": "Water Usage Liters",
            "description": "How water usage is estimated (material-based)."
          },
          "breakdown": {
            "additionalProperties": true,
            "type": "object",
            "title": "Breakdown",
            "description": "How material_score, logistics_score, and weight_impact are derived."
          },
          "disclaimer": {
            "type": "string",
            "title": "Disclaimer",
            "description": "Legal/disclaimer text: results are indicative, not certified LCA."
          }
        },
        "type": "object",
        "required": [
          "description",
          "total_sustainability_score",
          "co2_estimate_kg",
          "water_usage_liters",
          "breakdown",
          "disclaimer"
        ],
        "title": "MethodologyResponse",
        "description": "JSON explanation of how scores and estimates are calculated (for transparency and trust)."
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    },
    "securitySchemes": {
      "APIKeyHeader": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key",
        "description": "API key for authentication. Get your key from the provider."
      }
    }
  },
  "security": [
    {
      "APIKeyHeader": []
    }
  ],
  "x-rapidapi-info": {
    "tags": [
      "Sustainability",
      "CBAM",
      "Scope 3",
      "AI Agent Tool",
      "E-commerce"
    ]
  }
}